(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[208],{8978:function(e,t,s){Promise.resolve().then(s.bind(s,794))},794:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var r=s(7437),a=s(2265),n=s(9376),i=s(6631);let o=[{id:1,name:"Cultivator",emoji:"\uD83C\uDF1F",price:5,boost:100,color:"from-green-500 to-emerald-600"},{id:2,name:"Dao Seeker",emoji:"⭐",price:10,boost:200,color:"from-amber-500 to-yellow-600"},{id:3,name:"Immortal",emoji:"\uD83D\uDC8E",price:15,boost:400,color:"from-purple-500 to-pink-600"},{id:4,name:"Divine",emoji:"\uD83D\uDC51",price:22,boost:800,color:"from-rose-500 to-red-600"}],l=[{months:1,label:"1 Month",discount:0},{months:6,label:"6 Months",discount:10},{months:12,label:"1 Year",discount:20}];function d(){var e;let{isAuthenticated:t,isLoading:s,discordId:d,server:c}=(0,i.a)(),m=(0,n.useRouter)(),[u,x]=(0,a.useState)(1),[h,b]=(0,a.useState)(1),[p,g]=(0,a.useState)(!1),[f,v]=(0,a.useState)(""),[j,N]=(0,a.useState)(null);if((0,a.useEffect)(()=>{s||t||m.push("/")},[s,t,m]),(0,a.useEffect)(()=>{t&&d&&fetch("/api/subscriptions/status?discordId=".concat(d,"&server=").concat(c||"S0")).then(e=>e.json()).then(e=>{e.hasActiveSubscription&&N(e.subscription)}).catch(console.error)},[t,d,c]),s||!t)return(0,r.jsx)("div",{className:"h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"spinner"})});let w=o.find(e=>e.id===u),S=l.find(e=>e.months===h),y=w.price*S.months,C=Math.round(y*(1-S.discount/100)*100)/100,k=y-C,D=(null==j?void 0:j.tier)||0,I=u>D,E=u===D&&D>0,A=async()=>{g(!0),v("");try{let e=await fetch("/api/subscriptions/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tierId:u,months:h,amount:C,discordId:d,server:c||"S0"})});if(!e.ok)throw Error("Failed to create order");let t=await e.json();t.approvalUrl&&(window.location.href=t.approvalUrl)}catch(e){v(e.message)}finally{g(!1)}};return(0,r.jsx)("div",{className:"min-h-screen p-4 pb-24 md:pb-8",children:(0,r.jsxs)("div",{className:"max-w-lg mx-auto",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("button",{onClick:()=>m.push("/shop"),className:"text-gray-400 hover:text-white text-sm",children:"← Back"}),(0,r.jsx)("h1",{className:"text-xl font-bold text-amber-400",children:"Subscriptions"}),(0,r.jsx)("div",{className:"w-12"})]}),j&&(0,r.jsx)("div",{className:"glass rounded-xl p-4 mb-6 border border-green-500/30",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"text-2xl",children:null===(e=o.find(e=>e.id===j.tier))||void 0===e?void 0:e.emoji}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("div",{className:"text-white font-bold",children:j.tier_name}),(0,r.jsxs)("div",{className:"text-green-400 text-sm",children:["+",j.qi_boost_percent,"% Active"]})]}),(0,r.jsxs)("div",{className:"text-right text-xs text-gray-400",children:["Expires",(0,r.jsx)("br",{}),new Date(j.expires_at).toLocaleDateString()]})]})}),(0,r.jsxs)("div",{className:"glass rounded-xl p-4 mb-4",children:[(0,r.jsx)("div",{className:"text-sm text-gray-400 mb-3 font-medium",children:"Select Tier"}),(0,r.jsx)("div",{className:"space-y-2",children:o.map(e=>(0,r.jsxs)("button",{onClick:()=>x(e.id),className:"w-full p-3 rounded-lg flex items-center justify-between transition-all ".concat(u===e.id?"bg-amber-500/20 border border-amber-500":"bg-white/5 border border-transparent hover:bg-white/10"),children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"text-2xl",children:e.emoji}),(0,r.jsxs)("div",{className:"text-left",children:[(0,r.jsxs)("div",{className:"text-white font-medium flex items-center gap-2",children:[e.name,e.id===D&&(0,r.jsx)("span",{className:"text-[10px] bg-green-500 text-white px-1.5 py-0.5 rounded",children:"CURRENT"})]}),(0,r.jsxs)("div",{className:"text-gray-400 text-xs",children:["+",e.boost,"% Qi Boost"]})]})]}),(0,r.jsxs)("div",{className:"text-amber-400 font-bold",children:["$",e.price,"/mo"]})]},e.id))})]}),(0,r.jsxs)("div",{className:"glass rounded-xl p-4 mb-4",children:[(0,r.jsx)("div",{className:"text-sm text-gray-400 mb-3 font-medium",children:"Select Duration"}),(0,r.jsx)("div",{className:"grid grid-cols-3 gap-2",children:l.map(e=>(0,r.jsxs)("button",{onClick:()=>b(e.months),className:"p-3 rounded-lg text-center transition-all ".concat(h===e.months?"bg-amber-500/20 border border-amber-500":"bg-white/5 border border-transparent hover:bg-white/10"),children:[(0,r.jsx)("div",{className:"text-white font-medium text-sm",children:e.label}),e.discount>0&&(0,r.jsxs)("div",{className:"text-green-400 text-xs font-bold",children:["-",e.discount,"%"]})]},e.months))})]}),(0,r.jsxs)("div",{className:"glass rounded-xl p-4 mb-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsxs)("span",{className:"text-gray-400 text-sm",children:[w.name," \xd7 ",S.label]}),k>0&&(0,r.jsxs)("span",{className:"text-green-400 text-sm font-bold",children:["Save $",k.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-white font-bold text-lg",children:"Total"}),(0,r.jsxs)("span",{className:"text-amber-400 font-bold text-2xl",children:["$",C.toFixed(2)]})]}),I&&j&&(0,r.jsxs)("div",{className:"text-purple-400 text-xs mt-2",children:["Upgrading from ",j.tier_name]}),E&&(0,r.jsx)("div",{className:"text-green-400 text-xs mt-2",children:"Extending your current subscription"})]}),f&&(0,r.jsx)("div",{className:"bg-red-500/20 border border-red-500 text-red-400 p-3 rounded-lg mb-4 text-sm",children:f}),(0,r.jsx)("button",{onClick:A,disabled:p,className:"w-full py-4 rounded-xl font-bold text-white text-lg transition-all ".concat(p?"bg-gray-600":I?"bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700":E?"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700":"bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700"),children:p?"Processing...":I?"Upgrade - $".concat(C.toFixed(2)):E?"Extend - $".concat(C.toFixed(2)):"Subscribe - $".concat(C.toFixed(2))}),(0,r.jsx)("p",{className:"text-center text-gray-500 text-xs mt-4",children:"Secure payment via PayPal"})]})})}},6631:function(e,t,s){"use strict";s.d(t,{a:function(){return n}});var r=s(605),a=s(2265);function n(){let{data:e,status:t}=(0,r.useSession)(),[s,n]=(0,a.useState)(null),[i,o]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{{let e=localStorage.getItem("codeAuth");if(e)try{n(JSON.parse(e))}catch(e){localStorage.removeItem("codeAuth")}o(!0)}},[]),null==e?void 0:e.user)?{isAuthenticated:!0,isLoading:!1,discordId:e.user.id||null,server:"S0",userName:e.user.name||null,userImage:e.user.image||null,isCodeAuth:!1,logout:()=>{}}:s?{isAuthenticated:!0,isLoading:!1,discordId:s.discordId,server:s.server,userName:null,userImage:null,isCodeAuth:!0,logout:()=>{s&&(localStorage.removeItem("codeAuth"),n(null),window.location.reload())}}:{isAuthenticated:!1,isLoading:"loading"===t||!i,discordId:null,server:null,userName:null,userImage:null,isCodeAuth:!1,logout:()=>{}}}},9376:function(e,t,s){"use strict";var r=s(5475);s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[605,971,117,744],function(){return e(e.s=8978)}),_N_E=e.O()}]);